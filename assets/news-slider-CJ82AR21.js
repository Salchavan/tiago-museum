import"./tailwindcss-CRRPhJTw.js";document.addEventListener("DOMContentLoaded",()=>{const r=document.getElementById("backToTop");document.addEventListener("keydown",s=>{s.ctrlKey&&s.key.toLowerCase()==="k"&&(s.preventDefault(),window.location.href=new URL("login.html","/tiago-museum/").toString())}),r&&(window.addEventListener("scroll",()=>{window.pageYOffset>300?r.classList.remove("hidden"):r.classList.add("hidden")}),r.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})})),document.querySelectorAll('a[href^="#"]').forEach(s=>{s.addEventListener("click",n=>{n.preventDefault();const t=s.getAttribute("href");if(!t||t==="#")return;const i=document.querySelector(t);i&&window.scrollTo({top:i.offsetTop-80,behavior:"smooth"})})}),document.querySelector("button.md\\:hidden")?.addEventListener("click",()=>{alert("Mobile menu would open here. In a real implementation, this would show/hide a menu.")})});const m=()=>{const r=document.getElementById("open-reservation-modal"),e=document.getElementById("reservation-modal"),s=e?.querySelector("[data-modal-close]");if(!r||!e)return;const n=t=>{t?(e.classList.remove("hidden"),document.body.classList.add("overflow-hidden")):(e.classList.add("hidden"),document.body.classList.remove("overflow-hidden"))};r.addEventListener("click",()=>n(!0)),s?.addEventListener("click",()=>n(!1)),e.addEventListener("click",t=>{t.target===e&&n(!1)}),document.addEventListener("keydown",t=>{t.key==="Escape"&&!e.classList.contains("hidden")&&n(!1)})};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",m):m();const p=()=>{const r=document.getElementById("open-restorations-modal"),e=document.getElementById("restorations-modal"),s=e?.querySelector("[data-modal-close]");if(!r||!e)return;const n=t=>{t?(e.classList.remove("hidden"),document.body.classList.add("overflow-hidden")):(e.classList.add("hidden"),document.body.classList.remove("overflow-hidden"))};r.addEventListener("click",()=>n(!0)),s?.addEventListener("click",()=>n(!1)),e.addEventListener("click",t=>{t.target===e&&n(!1)}),document.addEventListener("keydown",t=>{t.key==="Escape"&&!e.classList.contains("hidden")&&n(!1)})};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",p):p();const f=()=>{const r=document.getElementById("open-news-modal"),e=document.getElementById("news-modal"),s=e?.querySelector("[data-modal-close]"),n=e?.querySelector("#news-modal-list");if(!r||!e)return;const t=i=>{i?(e.classList.remove("hidden"),document.body.classList.add("overflow-hidden")):(e.classList.add("hidden"),document.body.classList.remove("overflow-hidden"))};r.addEventListener("click",()=>t(!0)),s?.addEventListener("click",()=>t(!1)),e.addEventListener("click",i=>{i.target===e&&t(!1)}),document.addEventListener("keydown",i=>{i.key==="Escape"&&!e.classList.contains("hidden")&&t(!1)}),n&&L(n)},L=async r=>{r.innerHTML=`
    <div class="text-gray-500 text-sm col-span-full">
      Cargando noticias...
    </div>
  `;try{const e=await fetch(new URL("data/n.json","/tiago-museum/").toString());if(!e.ok)throw new Error("No se pudo obtener la lista de noticias");const s=await e.json();if(!s.length){r.innerHTML=`
        <div class="text-gray-500 text-sm col-span-full text-center py-8">
          No hay noticias disponibles en este momento.
        </div>
      `;return}const n=document.createDocumentFragment();s.forEach(t=>{n.appendChild(E(t))}),r.innerHTML="",r.appendChild(n)}catch(e){console.error("Error al cargar las noticias:",e),r.innerHTML=`
      <div class="text-red-600 text-sm col-span-full text-center py-8">
        No se pudieron cargar las noticias. Inténtalo nuevamente más tarde.
      </div>
    `}},E=r=>{const e=document.createElement("article");e.className="bg-gray-50 border border-gray-100 rounded-2xl p-4 flex flex-col gap-3";const s=new Date(r.date),n=isNaN(s.getTime())?r.date:s.toLocaleDateString("es-ES",{day:"2-digit",month:"long",year:"numeric"});e.innerHTML=`
    <div class="flex items-center justify-between text-xs uppercase tracking-wide text-gray-500">
      <span class="font-semibold text-black/70">${r.type}</span>
      <span>${n}</span>
    </div>
    <h4 class="text-lg font-semibold leading-snug">${r.title}</h4>
    <p class="text-sm text-gray-600 flex-1">${r.description}</p>
    <a class="text-sm font-semibold gold-text hover:underline inline-flex items-center gap-2 mt-auto">
      <span>Ver detalle</span>
      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h14m-6-6 6 6-6 6" />
      </svg>
    </a>
  `;const t=e.querySelector("a");return t&&(t.setAttribute("href",r.link||"#"),t.setAttribute("target","_blank"),t.setAttribute("rel","noopener noreferrer")),e};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",f):f();const v=()=>{const r=document.getElementById("open-donation-modal"),e=document.getElementById("donation-modal"),s=e?.querySelector("[data-modal-close]");if(!r||!e)return;const n=t=>{t?(e.classList.remove("hidden"),document.body.classList.add("overflow-hidden")):(e.classList.add("hidden"),document.body.classList.remove("overflow-hidden"))};r.addEventListener("click",()=>n(!0)),s?.addEventListener("click",()=>n(!1)),e.addEventListener("click",t=>{t.target===e&&n(!1)}),document.addEventListener("keydown",t=>{t.key==="Escape"&&!e.classList.contains("hidden")&&n(!1)})};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",v):v();const g=()=>{const r=document.getElementById("open-comment-modal"),e=document.getElementById("comment-modal"),s=e?.querySelector("[data-modal-close]"),n=e?.querySelector("#comment-status");if(!r||!e)return;const t=o=>{if(n){if(!o){n.textContent="",n.classList.add("hidden");return}n.textContent=o,n.classList.remove("hidden")}},i=o=>{o?(e.classList.remove("hidden"),document.body.classList.add("overflow-hidden"),t(null)):(e.classList.add("hidden"),document.body.classList.remove("overflow-hidden"),t(null))};r.addEventListener("click",()=>i(!0)),s?.addEventListener("click",()=>i(!1)),e.addEventListener("click",o=>{o.target===e&&i(!1)}),document.addEventListener("keydown",o=>{o.key==="Escape"&&!e.classList.contains("hidden")&&i(!1)});const a=e.querySelector("#comment-form");a?.addEventListener("submit",o=>{if(o.preventDefault(),!a.checkValidity()){t("Completa todos los campos para enviar el comentario.");return}t(null),a.reset(),i(!1)}),a?.addEventListener("input",()=>{t(null)})};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",g):g();const w=()=>{const r=document.getElementById("comments-cards");r&&S(r)},S=async r=>{r.innerHTML=`
    <div class="text-gray-500 text-sm col-span-full">
      Cargando comentarios...
    </div>
  `;try{const e=await fetch(new URL("data/c.json","/tiago-museum/").toString());if(!e.ok)throw new Error("No se pudo obtener la lista de comentarios");const s=await e.json();if(!Array.isArray(s)||s.length===0){r.innerHTML=`
        <div class="text-gray-500 text-sm col-span-full text-center py-8">
          No hay comentarios disponibles en este momento.
        </div>
      `;return}const n=[...s].sort((i,a)=>{const o=y(i.date)?.getTime()??-1/0;return(y(a.date)?.getTime()??-1/0)-o});r.innerHTML="";const t=document.createDocumentFragment();for(const i of n)t.appendChild(k(i));r.appendChild(t)}catch(e){console.error("Error al cargar comentarios de la sección:",e),r.innerHTML=`
      <div class="text-red-600 text-sm col-span-full text-center py-8">
        No se pudieron cargar los comentarios.
      </div>
    `}},k=r=>{const e=document.createElement("article");e.className="bg-white rounded-lg overflow-hidden shadow-lg news-card";const s=document.createElement("div");s.className="p-6";const n=document.createElement("div");n.className="flex flex-row items-center gap-4 mb-4";const t=document.createElement("img");t.src=r.perfilicon,t.alt=`Foto de ${r.username}`,t.className="h-16 w-16 rounded-full object-cover";const i=document.createElement("div"),a=document.createElement("h3");a.className="text-xl font-bold",a.textContent=r.username;const o=document.createElement("span");o.className="text-gray-500 text-sm",o.textContent=r.date,i.appendChild(a),i.appendChild(o),n.appendChild(t),n.appendChild(i);const d=document.createElement("p");return d.className="text-gray-700",d.textContent=r.text,s.appendChild(n),s.appendChild(d),e.appendChild(s),e};function y(r){const e=/^([0-9]{2})\/([0-9]{2})\/([0-9]{4})$/.exec(r.trim());if(!e){const l=new Date(r);return isNaN(l.getTime())?null:l}const[,s,n,t]=e,i=Number(s),a=Number(n),o=Number(t);if(!Number.isFinite(i)||!Number.isFinite(a)||!Number.isFinite(o))return null;const d=new Date(o,i-1,a);return isNaN(d.getTime())?null:d}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",w):w();let u=null;const x=()=>{const r=document.getElementById("reservation-form"),e=document.getElementById("reservation-status");!r||!e||r.addEventListener("submit",async s=>{s.preventDefault();const n=C(new FormData(r));if(!n){c(e,"Completa todos los campos obligatorios.","error");return}c(e,"Enviando reserva...","info");try{const t=await I(n);r.reset(),t==="download"?c(e,"Reserva guardada. Se descargó a.json actualizado (reemplaza public/data/a.json).","success"):t==="api"?c(e,"Reserva guardada en public/data/a.json.","success"):c(e,"Reserva enviada correctamente. Te contactaremos a la brevedad.","success")}catch(t){console.error("Error al enviar la reserva:",t),c(e,"No se pudo guardar la reserva. Intenta nuevamente más tarde.","error")}})},C=r=>{const e=l=>String(r.get(l)??"").trim(),s=e("date"),n=e("time"),t=e("dni"),i=e("name"),a=e("tel"),o=e("mail"),d=Number(r.get("cuantity"));return!s||!n||!t||!i||!a||!o||!Number.isFinite(d)||d<=0?null:{date:s,time:n,dni:t,name:i,tel:a,mail:o,cuantity:d}},c=(r,e,s)=>{const n={info:"text-gray-600",success:"text-green-600",error:"text-red-600"};r.textContent=e,r.classList.remove("text-gray-600","text-green-600","text-red-600"),r.classList.add(n[s])};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",x):x();const I=async r=>{try{return await T(r),"api"}catch{}if(window.showOpenFilePicker){const s=await N(),n=await P(s),t={id:b(n),...r};return n.push(t),await D(s,n),"file"}return await B(r),"download"},T=async r=>{const e=await fetch("/api/reservations",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}),s=await e.json().catch(()=>null);if(!e.ok||!s?.success)throw new Error(s?.message||"No se pudo guardar la reserva")},N=async()=>{if(u)return u;const r=window.showOpenFilePicker;if(!r)throw new Error("No disponible showOpenFilePicker");const[e]=await r({multiple:!1,types:[{description:"Archivo JSON",accept:{"application/json":[".json"]}}]});if(!e)throw new Error("No se seleccionó ningún archivo");return u=e,e},B=async r=>{const e=await M(),s={id:b(e),...r},n=[...e,s];localStorage.setItem("tiago-museum:reservations",JSON.stringify(n)),A("a.json",n)},M=async()=>{const r=localStorage.getItem("tiago-museum:reservations");if(r)try{const e=JSON.parse(r);if(Array.isArray(e))return e}catch{}try{const e=await fetch(new URL("data/a.json","/tiago-museum/").toString(),{cache:"no-store"});if(!e.ok)return[];const s=await e.json();return Array.isArray(s)?s:[]}catch{return[]}},A=(r,e)=>{const s=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),n=URL.createObjectURL(s),t=document.createElement("a");t.href=n,t.download=r,document.body.appendChild(t),t.click(),t.remove(),URL.revokeObjectURL(n)},P=async r=>{const s=await(await r.getFile()).text();if(!s.trim())return[];const n=JSON.parse(s);return Array.isArray(n)?n.filter(t=>!t||typeof t!="object"?!1:typeof t.id=="string"):[]},D=async(r,e)=>{const s=await r.createWritable();await s.write(JSON.stringify(e,null,2)),await s.close()},b=r=>{const e=r.reduce((s,n)=>{const t=Number(n.id);return Number.isFinite(t)&&t>s?t:s},0);return String(e+1)};class V{restorations=[];currentIndex=0;slidesPerView=3;autoSlideInterval=null;autoSlideDelay=5e3;sliderTrack;dotsContainer;prevBtn;nextBtn;sliderViewport;modalListContainer;constructor(){this.sliderTrack=document.getElementById("slider-track"),this.dotsContainer=document.getElementById("dots-container"),this.prevBtn=document.getElementById("prev-btn"),this.nextBtn=document.getElementById("next-btn"),this.modalListContainer=document.getElementById("restorations-modal-list");const e=this.sliderTrack.parentElement;if(!e)throw new Error("Slider viewport element not found");this.sliderViewport=e,this.setupEventListeners(),this.updateSlidesPerView(),window.addEventListener("resize",()=>this.updateSlidesPerView()),this.loadRestorations()}async loadRestorations(){try{const e=await fetch(new URL("data/r.json","/tiago-museum/").toString());this.restorations=await e.json(),this.renderSliderCards(),this.renderModalCards(),this.startAutoSlide()}catch(e){console.error("Error cargando las restauraciones:",e),this.showErrorState()}}updateSlidesPerView(){const e=window.innerWidth;e<768?this.slidesPerView=1:e<1024?this.slidesPerView=2:this.slidesPerView=3,this.currentIndex=0,this.renderSliderCards()}renderSliderCards(){if(this.sliderTrack.innerHTML="",this.dotsContainer.innerHTML="",!this.restorations.length)return;const e=100/this.slidesPerView;this.restorations.forEach(n=>{const t=document.createElement("div");t.className="flex-none px-2 md:px-3",t.style.width=`${e}%`;const i=this.createRestorationCard(n,"slider");t.appendChild(i),this.sliderTrack.appendChild(t)});const s=Math.max(1,Math.ceil(this.restorations.length/this.slidesPerView));for(let n=0;n<s;n++){const t=document.createElement("button");t.className=`w-3 h-3 rounded-full transition-all duration-300 ${n===this.currentIndex?"bg-black scale-125":"bg-gray-300 hover:bg-gray-400"}`,t.setAttribute("data-slide",n.toString()),t.addEventListener("click",()=>this.goToSlide(n)),this.dotsContainer.appendChild(t)}this.currentIndex>=s&&(this.currentIndex=s-1),this.updateSliderPosition()}createRestorationCard(e,s="slider"){const n=document.createElement("div");n.className="bg-white rounded-lg overflow-hidden shadow-lg news-card flex flex-col",s==="slider"&&n.classList.add("h-full");const t=new Date(e.date_started).toLocaleDateString("es-ES",{month:"long",year:"numeric"});return n.innerHTML=`
      <div class="relative overflow-hidden group">
        <img 
          src="${e.image}" 
          alt="${e.title}"
          class="w-full h-48 object-cover transition-transform duration-500 group-hover:scale-110"
          loading="lazy"
        />
        <div class="absolute inset-0 bg-gradient-to-t from-black/40 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
        <div class="absolute bottom-0 left-0 right-0 p-4 transform translate-y-full group-hover:translate-y-0 transition-transform duration-300">
          <span class="text-white text-sm bg-black/70 px-3 py-1 rounded-full">
            Iniciado: ${t}
          </span>
        </div>
      </div>
      <div class="p-6 flex-1 flex flex-col">
        <h3 class="text-xl font-bold mb-3 line-clamp-1">${e.title}</h3>
        <p class="text-gray-600 mb-4 flex-1 line-clamp-3">${e.description}</p>
        <a 
          href="#" 
          class="gold-text font-semibold hover:underline inline-flex items-center justify-between mt-auto"
          data-restoration-id="${e.restoration_id}"
        >
          <span>Ver proyecto</span>
          <svg class="w-4 h-4 ml-2 transform transition-transform group-hover:translate-x-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"/>
          </svg>
        </a>
      </div>
    `,n.classList.add("group"),n.querySelector("a")?.addEventListener("click",a=>{a.preventDefault(),this.handleProjectClick(e.restoration_id)}),n}renderModalCards(){if(this.modalListContainer){if(this.modalListContainer.innerHTML="",!this.restorations.length){this.modalListContainer.innerHTML=`
        <div class="text-gray-500 text-sm col-span-full text-center py-8">
          No hay restauraciones disponibles en este momento.
        </div>
      `;return}this.restorations.forEach(e=>{const s=this.createRestorationCard(e,"modal");this.modalListContainer?.appendChild(s)})}}setupEventListeners(){this.prevBtn.addEventListener("click",()=>this.prevSlide()),this.nextBtn.addEventListener("click",()=>this.nextSlide()),this.sliderTrack.addEventListener("mouseenter",()=>this.stopAutoSlide()),this.sliderTrack.addEventListener("mouseleave",()=>this.startAutoSlide()),this.prevBtn.addEventListener("mouseenter",()=>this.stopAutoSlide()),this.nextBtn.addEventListener("mouseenter",()=>this.stopAutoSlide()),document.addEventListener("keydown",n=>{n.key==="ArrowLeft"&&this.prevSlide(),n.key==="ArrowRight"&&this.nextSlide()});let e=0,s=0;this.sliderTrack.addEventListener("touchstart",n=>{e=n.changedTouches[0].screenX,this.stopAutoSlide()}),this.sliderTrack.addEventListener("touchend",n=>{s=n.changedTouches[0].screenX,this.handleSwipe(e,s),this.startAutoSlide()})}handleSwipe(e,s){const t=e-s;Math.abs(t)>50&&(t>0?this.nextSlide():this.prevSlide())}prevSlide(){const e=Math.ceil(this.restorations.length/this.slidesPerView);this.currentIndex=(this.currentIndex-1+e)%e,this.updateSliderPosition()}nextSlide(){const e=Math.ceil(this.restorations.length/this.slidesPerView);this.currentIndex=(this.currentIndex+1)%e,this.updateSliderPosition()}goToSlide(e){this.currentIndex=e,this.updateSliderPosition()}updateSliderPosition(){const e=this.sliderViewport.getBoundingClientRect().width,s=-this.currentIndex*e;this.sliderTrack.style.transform=`translateX(${s}px)`,this.dotsContainer.querySelectorAll("button").forEach((t,i)=>{i===this.currentIndex?(t.classList.remove("bg-gray-300"),t.classList.add("bg-black","scale-125")):(t.classList.remove("bg-black","scale-125"),t.classList.add("bg-gray-300"))})}startAutoSlide(){this.autoSlideInterval&&clearInterval(this.autoSlideInterval),!(Math.ceil(this.restorations.length/this.slidesPerView)<=1)&&(this.autoSlideInterval=window.setInterval(()=>{this.nextSlide()},this.autoSlideDelay))}stopAutoSlide(){this.autoSlideInterval&&(clearInterval(this.autoSlideInterval),this.autoSlideInterval=null)}handleProjectClick(e){console.log("Ver proyecto:",e),alert(`Ver detalles del proyecto ${e}`)}showErrorState(){this.sliderTrack.innerHTML=`
      <div class="w-full text-center py-12">
        <svg class="w-16 h-16 mx-auto text-gray-400 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.998-.833-2.732 0L4.732 16.5c-.77.833.192 2.5 1.732 2.5z"/>
        </svg>
        <h3 class="text-xl font-semibold text-gray-700 mb-2">Error al cargar</h3>
        <p class="text-gray-500">No se pudieron cargar las restauraciones. Por favor, intenta más tarde.</p>
        <button id="retry-btn" class="mt-4 px-6 py-2 bg-black text-white rounded-lg hover:bg-gray-800 transition-colors">
          Reintentar
        </button>
      </div>
    `,document.getElementById("retry-btn")?.addEventListener("click",()=>{this.loadRestorations()})}}document.addEventListener("DOMContentLoaded",()=>{new V});class R{items=[];currentIndex=0;slidesPerView=3;autoSlideInterval=null;autoSlideDelay=5e3;sliderTrack;dotsContainer;prevBtn;nextBtn;sliderViewport;constructor(){const e=document.getElementById("news-slider-track"),s=document.getElementById("news-dots-container"),n=document.getElementById("news-prev-btn"),t=document.getElementById("news-next-btn");if(!e||!s||!n||!t)return;this.sliderTrack=e,this.dotsContainer=s,this.prevBtn=n,this.nextBtn=t;const i=this.sliderTrack.parentElement;if(!i)throw new Error("News slider viewport element not found");this.sliderViewport=i,this.setupEventListeners(),this.updateSlidesPerView(),window.addEventListener("resize",()=>this.updateSlidesPerView()),this.loadNews()}async loadNews(){try{const e=await fetch(new URL("data/n.json","/tiago-museum/").toString());if(!e.ok)throw new Error("No se pudo obtener la lista de noticias");const s=await e.json();this.items=Array.isArray(s)?s:[],this.items=[...this.items].sort((n,t)=>{const i=this.parseMmDdYyyy(n.date)?.getTime()??-1/0;return(this.parseMmDdYyyy(t.date)?.getTime()??-1/0)-i}),this.renderSliderCards(),this.startAutoSlide()}catch(e){console.error("Error cargando las noticias:",e),this.showErrorState()}}updateSlidesPerView(){const e=window.innerWidth;e<768?this.slidesPerView=1:e<1024?this.slidesPerView=2:this.slidesPerView=3,this.currentIndex=0,this.renderSliderCards()}renderSliderCards(){if(this.sliderTrack.innerHTML="",this.dotsContainer.innerHTML="",!this.items.length){this.sliderTrack.innerHTML=`
        <div class="w-full text-center py-8 text-gray-500 text-sm">
          No hay noticias disponibles en este momento.
        </div>
      `;return}const e=100/this.slidesPerView;this.items.forEach(n=>{const t=document.createElement("div");t.className="flex-none px-2 md:px-3",t.style.width=`${e}%`;const i=this.createNewsCard(n);t.appendChild(i),this.sliderTrack.appendChild(t)});const s=Math.max(1,Math.ceil(this.items.length/this.slidesPerView));for(let n=0;n<s;n++){const t=document.createElement("button");t.className=`w-3 h-3 rounded-full transition-all duration-300 ${n===this.currentIndex?"bg-black scale-125":"bg-gray-300 hover:bg-gray-400"}`,t.setAttribute("data-slide",n.toString()),t.addEventListener("click",()=>this.goToSlide(n)),this.dotsContainer.appendChild(t)}this.currentIndex>=s&&(this.currentIndex=s-1),this.updateSliderPosition()}createNewsCard(e){const s=document.createElement("article");return s.className="bg-white rounded-lg overflow-hidden shadow-lg news-card flex flex-col group h-full",s.innerHTML=`
      <div class="relative overflow-hidden">
        <img 
          src="${e.image}" 
          alt="${this.escapeHtml(e.title)}"
          class="w-full h-48 object-cover transition-transform duration-500 group-hover:scale-110"
          loading="lazy"
        />
        <div class="absolute inset-0 bg-gradient-to-t from-black/40 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
      </div>
      <div class="p-6 flex-1 flex flex-col">
        <div class="flex justify-between items-center mb-4">
          <span class="text-sm font-semibold gold-text">${this.escapeHtml(e.type)}</span>
          <span class="text-gray-500 text-sm">${this.escapeHtml(e.date)}</span>
        </div>
        <h3 class="text-xl font-bold mb-3 line-clamp-2">${this.escapeHtml(e.title)}</h3>
        <p class="text-gray-700 mb-4 flex-1 line-clamp-3">${this.escapeHtml(e.description)}</p>
        <a 
          class="gold-text font-semibold hover:underline inline-flex items-center mt-auto"
          href="${e.link||"#"}"
          target="_blank"
          rel="noopener noreferrer"
        >
          <span>Saber más</span>
          <svg class="w-4 h-4 ml-2 transform transition-transform group-hover:translate-x-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"/>
          </svg>
        </a>
      </div>
    `,s}setupEventListeners(){this.prevBtn.addEventListener("click",()=>this.prevSlide()),this.nextBtn.addEventListener("click",()=>this.nextSlide()),this.sliderTrack.addEventListener("mouseenter",()=>this.stopAutoSlide()),this.sliderTrack.addEventListener("mouseleave",()=>this.startAutoSlide()),this.prevBtn.addEventListener("mouseenter",()=>this.stopAutoSlide()),this.nextBtn.addEventListener("mouseenter",()=>this.stopAutoSlide());let e=0,s=0;this.sliderTrack.addEventListener("touchstart",n=>{e=n.changedTouches[0].screenX,this.stopAutoSlide()}),this.sliderTrack.addEventListener("touchend",n=>{s=n.changedTouches[0].screenX,this.handleSwipe(e,s),this.startAutoSlide()})}handleSwipe(e,s){const t=e-s;Math.abs(t)>50&&(t>0?this.nextSlide():this.prevSlide())}prevSlide(){const e=Math.ceil(this.items.length/this.slidesPerView);e<=1||(this.currentIndex=(this.currentIndex-1+e)%e,this.updateSliderPosition())}nextSlide(){const e=Math.ceil(this.items.length/this.slidesPerView);e<=1||(this.currentIndex=(this.currentIndex+1)%e,this.updateSliderPosition())}goToSlide(e){this.currentIndex=e,this.updateSliderPosition()}updateSliderPosition(){const e=this.sliderViewport.getBoundingClientRect().width,s=-this.currentIndex*e;this.sliderTrack.style.transform=`translateX(${s}px)`,this.dotsContainer.querySelectorAll("button").forEach((t,i)=>{i===this.currentIndex?(t.classList.remove("bg-gray-300"),t.classList.add("bg-black","scale-125")):(t.classList.remove("bg-black","scale-125"),t.classList.add("bg-gray-300"))})}startAutoSlide(){this.autoSlideInterval&&clearInterval(this.autoSlideInterval),!(Math.ceil(this.items.length/this.slidesPerView)<=1)&&(this.autoSlideInterval=window.setInterval(()=>{this.nextSlide()},this.autoSlideDelay))}stopAutoSlide(){this.autoSlideInterval&&(clearInterval(this.autoSlideInterval),this.autoSlideInterval=null)}showErrorState(){this.sliderTrack.innerHTML=`
      <div class="w-full text-center py-12">
        <svg class="w-16 h-16 mx-auto text-gray-400 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.998-.833-2.732 0L4.732 16.5c-.77.833.192 2.5 1.732 2.5z"/>
        </svg>
        <h3 class="text-xl font-semibold text-gray-700 mb-2">Error al cargar</h3>
        <p class="text-gray-500">No se pudieron cargar las noticias. Por favor, intenta más tarde.</p>
        <button id="news-retry-btn" class="mt-4 px-6 py-2 bg-black text-white rounded-lg hover:bg-gray-800 transition-colors">
          Reintentar
        </button>
      </div>
    `,document.getElementById("news-retry-btn")?.addEventListener("click",()=>{this.loadNews()})}parseMmDdYyyy(e){const s=/^([0-9]{2})\/([0-9]{2})\/([0-9]{4})$/.exec(e.trim());if(!s){const h=new Date(e);return isNaN(h.getTime())?null:h}const[,n,t,i]=s,a=Number(n),o=Number(t),d=Number(i);if(!Number.isFinite(a)||!Number.isFinite(o)||!Number.isFinite(d))return null;const l=new Date(d,a-1,o);return isNaN(l.getTime())?null:l}escapeHtml(e){return e.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;")}}document.addEventListener("DOMContentLoaded",()=>{new R});
